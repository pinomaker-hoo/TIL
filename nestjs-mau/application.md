# 응용 프로그램

애플리케이션은 AWS에 배포된 단일 Nest 애플리케이션(REST, GraphQL, gRPC, 워커 등)을 나타냅니다. 애플리케이션은 런타임 환경, 배포 구성, 애플리케이션 소스 코드 등 애플리케이션 구성을 정의하는 리소스의 모음입니다. 애플리케이션 구성에 따라 애플리케이션은 여러 노드로 구성될 수 있으며, 각 노드는 클라우드에서 실행되는 애플리케이션의 개별 인스턴스입니다.

## 1. 공급 전략

Mau를 사용하면 두 가지 방법으로 애플리케이션을 프로비저닝할 수 있습니다.

Fargate(서버리스) . 기본 옵션입니다. 애플리케이션을 실행하는 서버리스 컨테이너로 프로비저닝합니다. 이 전략은 애플리케이션을 호스팅하기 위해 실행 중인 가상 머신(EC2) 인스턴스가 필요하지 않습니다.

EC2: 자체 관리형 옵션(VPS) . 이 프로비저닝 전략을 사용하면 Mau가 애플리케이션을 호스팅할 EC2 인스턴스(가상 머신)를 프로비저닝합니다. 이 옵션을 사용하면 기본 인프라에 대한 제어력이 더욱 강화됩니다. 인스턴스 유형, 인스턴스 수 및 확장 전략을 선택할 수 있습니다. 참고: EC2로 프로비저닝된 애플리케이션은 동일 프로젝트 내 다른 애플리케이션과 가상 머신을 공유할 수 있습니다.

Fargate를 선택하든 EC2를 선택하든 Mau는 VPC, 서브넷, 보안 그룹 등 애플리케이션에 필요한 리소스를 자동으로 프로비저닝하므로 걱정할 필요가 없습니다. 궁극적으로 Fargate와 EC2 중 어떤 것을 선택할지는 애플리케이션의 요구 사항과 선호도에 따라 달라지지만, 애플리케이션에 설정하는 다른 구성에는 큰 영향을 미치지 않습니다.

### Fargate

Fargate는 컨테이너 워크로드를 위한 **서버리스 컴퓨팅 엔진**입니다. ECS 또는 EKS 위에서 동작하며, 애플리케이션을 실행하기 위한 EC2 인스턴스를 직접 관리하지 않아도 됩니다. 개발자는 컨테이너 이미지, vCPU·메모리 크기, 태스크 정의만 지정하면 되고, 노드 프로비저닝·패치·클러스터 용량 관리는 AWS가 대신 처리합니다.

- **아키텍처 관점**

  - ECS on Fargate: ECS 서비스/태스크를 Fargate에서 실행하며, EC2 인스턴스 없이도 클러스터를 운영할 수 있습니다.
  - EKS on Fargate: 특정 네임스페이스/라벨의 Kubernetes Pod를 Fargate에서 실행합니다.
  - 각 태스크/Pod는 격리된 컴퓨팅 환경에서 실행되어 보안 격리가 강화됩니다.

- **장점**

  - 서버(EC2) 관리가 필요 없어 운영 부담이 적습니다.
  - Idle 노드 비용 없이, 사용한 vCPU·메모리 시간에 대해서만 과금됩니다.
  - 작업 단위 격리로 멀티테넌트 환경에서 보안상 유리합니다.

- **단점 및 제약**

  - 장시간 고부하 워크로드에서는 EC2(예약 인스턴스, Savings Plans, Spot 등) 조합보다 비용이 높을 수 있습니다.
  - 로컬 디스크나 특수한 커널 튜닝이 필요한 워크로드에는 맞지 않을 수 있습니다.
  - 노드에 SSH로 직접 접속해 디버깅하는 패턴은 사용할 수 없으므로, CloudWatch Logs, X-Ray, OpenTelemetry 등을 통한 관측 구성이 중요합니다.

- **언제 Fargate를 선택할까?**
  - 트래픽이 예측하기 어렵고, 인프라를 직접 운영할 인력이 부족한 초기 단계 서비스
  - 일정 시간에만 강한 부하가 발생하는 배치/이벤트 기반 워크로드
  - 멀티테넌트 환경에서 테넌트별 격리 수준을 높이고 싶은 경우

요약하면, Fargate는 **운영 편의성과 보안 격리**에 초점을 맞춘 서버리스 컨테이너 실행 옵션이며, 장기·고정 부하 워크로드에서는 EC2 기반 전략과 비용·제어 수준을 비교해서 선택하는 것이 좋습니다.

### EC2

EC2는 AWS에서 제공하는 **가상 머신(인스턴스)** 서비스로, OS 레벨까지 사용자가 직접 제어할 수 있는 컴퓨팅 옵션입니다. Mau에서 EC2 전략을 선택하면 애플리케이션을 호스팅할 인스턴스를 Mau가 대신 프로비저닝하지만, 인스턴스 유형 선택과 확장 전략은 사용자가 결정할 수 있습니다.

- **특징**

  - 인스턴스 타입, 스토리지, 네트워크 옵션 등을 세밀하게 선택할 수 있습니다.
  - 동일 프로젝트 내 여러 애플리케이션이 하나의 EC2 인스턴스를 공유할 수 있으므로, 워크로드 패턴에 따라 비용을 최적화할 수 있습니다.
  - OS 레벨에서 에이전트 설치, 커널 파라미터 조정 등 고급 튜닝이 가능합니다.

- **장점**

  - 장기간 지속적인 트래픽이 있는 워크로드에서, 예약 인스턴스나 Savings Plans, Spot 인스턴스를 활용해 비용을 크게 절감할 수 있습니다.
  - 로컬 디스크 I/O, 특수 네트워킹 옵션, GPU 등 하드웨어 특성을 적극 활용할 수 있습니다.
  - 인스턴스에 직접 접속(SSH 등)하여 디버깅하거나 커스텀 모니터링 에이전트를 설치할 수 있습니다.

- **단점 및 고려사항**

  - 인스턴스 용량 계획과 Auto Scaling 그룹 설계 등을 직접 관리해야 합니다.
  - OS 패치, 보안 업데이트, 에이전트 버전 관리 등 운영 부담이 존재합니다.
  - 잘못된 용량 산정이나 스케일링 정책으로 인해 과소/과대 프로비저닝 문제가 발생할 수 있습니다.

- **언제 EC2를 선택할까?**

  - 항상 일정 수준 이상의 트래픽이 들어오는 핵심 서비스로, 장기적으로 비용 최적화가 중요한 경우
  - 로컬 디스크 성능, GPU, 특수 네트워크 설정 등 Fargate에서 제공하지 않는 인프라 특성이 중요한 워크로드
  - 인프라를 세밀하게 제어하고, OS/런타임 튜닝을 통해 성능을 극대화하고 싶은 경우

정리하면, EC2는 **제어권과 비용 최적화 잠재력**이 큰 대신 운영 복잡도가 높은 옵션입니다. Fargate와 EC2 중 어떤 전략을 선택할지는 애플리케이션의 트래픽 패턴, 팀의 인프라 운영 역량, 요구되는 인프라 제어 수준을 기준으로 결정하는 것이 좋습니다.
